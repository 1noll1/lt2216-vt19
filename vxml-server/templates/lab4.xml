<?xml version="1.0" encoding="UTF-8"?>
<vxml version="2.1" xmlns="http://www.w3.org/2001/vxml"
      xmlns:voxeo="http://community.voxeo.com/xmlns/vxml">
      
  <nomatch>
    Sorry, I didn't understand.
    <reprompt/>
  </nomatch>
  
  <noinput>
    You didn't say anything.
    <reprompt/>
  </noinput>

  <form id="welcome">
    <block>
      <prompt>
        <break time="2000" />
        Okay! Let's book your flight.
      </prompt>
      <goto next="#askFrom" />
    </block>
  </form>

  <form id="askFrom">
    <initial name="booking"> <!-- I'm not sure about this element, it says in the documentation that it's for form-wide information-->
      <grammar src="grammars/grammar4.xml"/>
      <prompt> 
        Please describe your trip.
      </prompt>
    </initial>
      <nomatch>
      I didn't understand. Please describe where you want to go from, where you want to go and when.
    </nomatch>
    <noinput>
      I couldn't hear you say anything.
    </noinput>

    <field name="fromField">
      <grammar src="grammars/grammar4.xml#fromCity"/>
      <prompt timeout="12s">
        What city are you leaving from?
      </prompt>
    </field>
    <nomatch>
      I didn't understand. You can say London, Paris or New York.
    </nomatch>
    <noinput>
      Please name your city of departure. You can say London, Paris or New York.
    </noinput>

    <field name="toField">
      <grammar src="grammars/grammar4.xml#destination"/>
      <prompt>
        Where are you going?
      </prompt>
    </field>

    <filled>
      <if cond="fromCity$.interpretation.fromCity == destination$.interpretation.destination"> 
        <prompt>
          Your destination must be different from the city of departure. Please name a city that is not <value expr="fromCity$.interpretation.fromCity" />.
          <break time="500" />
        </prompt>
        <goto next="#askFrom" />
      </if>      
    </filled>

    <field name="outDate">
      <grammar src="grammars/grammar4.xml#leaveDate"/>
      <prompt>On what weekday would you like to leave?</prompt>
    </field>

    <field name="returnDate">
      <grammar src="grammars/grammar4.xml#returnDate"/>
      <prompt>On what weekday would you like to return?</prompt>
    </field>

    <field name="foodMenu">
      <grammar src="grammars/grammar4.xml#foodMenu"/>
      <prompt bargein="false">
        <break time="2000" />
        We serve a variety of hot meals on board. What would you like to eat?
      </prompt>
    </field>

    <filled>
      <prompt bargein="false">
        <break time="2000" />
        So you want to go from <value expr="fromCity"/>
        to <value expr="destination"/>
        on <value expr="weekday"/>.
        <goto next="#grounding"/>
      </prompt>
    </filled>

  </form>

  <form id="grounding">
    <field name="groundMe" type="boolean">
      <prompt>
        Did I get that right?
      </prompt>
    </field>
    <filled>
      <if cond="groundMe">
        <goto next="#confirmation" />
      <else />
        <prompt>Sorry about that, let me ask you again.</prompt>
        <goto next="#booking" />
      </if>
    </filled>
  </form>

  <form id="confirmation">
    <block>
      <prompt bargein="false">
        Your flight has been booked! Thank you and good bye.
      </prompt>
    </block>
  </form>
</vxml>
